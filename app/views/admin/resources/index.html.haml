- page_title = @resource.model_name.human(count: 2)
- admin_title(page_title)

- content_for :main_grid do

  = render 'index'
  .row-fluid
    .span6
      %h1= page_title
    .pull-right{:style => "margin: 15px 5px 0 0;"}
      = admin_search

  = admin_display_flash_message

  - if @resource.typus_options_for(:counters) || @resource.typus_scopes.any? || predefined_filters.any?
    .tabbable.tabs-below

      %ul.nav.nav-tabs
      
        - all_klass = params[:scope] ? "inactive" : "active"
        %li{:class => all_klass}
          = link_to url_for(params.dup.cleanup.merge(:action => 'index')) do
            = Typus::I18n.t("All")
            - if @resource.typus_options_for(:counters)
              = "&nbsp;<span class='badge'>#{resource.count}</span>".html_safe

        - @resource.typus_scopes.each do |scope|
          - klass = params[:scope].eql?(scope) ? "active" : "inactive"
          %li{:class => klass}
            = link_to url_for(:scope => scope) do
              = Typus::I18n.t(scope, scope: "typus.scopes.#{@resource.model_name.singular}")
              - if @resource.typus_options_for(:counters)
                = "&nbsp; <span class='badge'>#{@resource.send(scope).count}</span>".html_safe

        - predefined_filters.each do |filter, action, scope|
          %li
            - url = action.is_a?(String) ? params.dup.cleanup.merge(:action => action) : action
            = link_to url do
              = Typus::I18n.t(filter)
              - if @resource.typus_options_for(:counters) && scope && @resource.respond_to?(scope)
                = "&nbsp;<span class='badge'>#{@resource.send(scope).count}</span>".html_safe

        - show_export_formats = (resource.any? && (formats = resource.typus_options_for(:export).extract_settings).any?)
        - if show_export_formats
          - formats.each do |format|
            %li= link_to format.upcase, :format => format, scope: params[:scope]

  = build_filters
  - if @items.any?
    - if controller.respond_to?(:bulk)
      = build_actions { build_list(@resource, fields, @items) }
    - else
      = build_list(@resource, fields, @items)
    = admin_paginate
  - else
    %p= Typus::I18n.t("No entries found.")
